<div class="page">
  <div class="toolbar">
    <h1 class="title">Registrar nuevo cliente</h1>
    <button class="back-link" (click)="cancel()">Regresar</button>
  </div>
  <span class="accent"></span>

  <form class="grid" [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- Columna izquierda: campos -->
    <div class="col form-col">
    <label class="form-field" [class.invalid]="f['nombre'].touched && f['nombre'].invalid">
      <span class="lbl required">Nombres</span>
      <input type="text" formControlName="nombre" />
      <small class="err" *ngIf="f['nombre'].touched && f['nombre'].errors">
        <ng-container *ngIf="f['nombre'].errors['required']">Este campo es obligatorio.</ng-container>
        <ng-container *ngIf="f['nombre'].errors['minlength']">Ingresa al menos 2 caracteres.</ng-container>
      </small>
    </label>

    <label class="form-field" [class.invalid]="f['apellido'].touched && f['apellido'].invalid">
      <span class="lbl required">Apellidos</span>
      <input type="text" formControlName="apellido" />
      <small class="err" *ngIf="f['apellido'].touched && f['apellido'].errors">
        <ng-container *ngIf="f['apellido'].errors['required']">Este campo es obligatorio.</ng-container>
        <ng-container *ngIf="f['apellido'].errors['minlength']">Ingresa al menos 2 caracteres.</ng-container>
      </small>
    </label>

    <label class="form-field" [class.invalid]="f['email'].touched && f['email'].invalid">
      <span class="lbl">Email</span>
      <input type="email" formControlName="email" />
      <small class="err" *ngIf="f['email'].touched && f['email'].errors">
        <ng-container *ngIf="f['email'].errors['email']">Email inválido.</ng-container>
      </small>
    </label>

    <label class="form-field" [class.invalid]="f['telefono'].touched && f['telefono'].invalid">
      <span class="lbl required">Número de Contacto</span>
      <input type="tel" formControlName="telefono" inputmode="numeric" placeholder="Solo números" />
      <small class="err" *ngIf="f['telefono'].touched && f['telefono'].errors">
        <ng-container *ngIf="f['telefono'].errors['required']">Este campo es obligatorio.</ng-container>
        <ng-container *ngIf="f['telefono'].errors['pattern']">Debe tener exactamente 9 dígitos.</ng-container>
      </small>
    </label>

    <label class="form-field" [class.invalid]="f['dni'].touched && f['dni'].invalid">
      <span class="lbl required">Documento de Identidad</span>
      <input type="text" formControlName="dni" inputmode="numeric" placeholder="Solo números" />
      <small class="err" *ngIf="f['dni'].touched && f['dni'].errors">
        <ng-container *ngIf="f['dni'].errors['required']">Este campo es obligatorio.</ng-container>
        <ng-container *ngIf="f['dni'].errors['pattern']">Debe tener exactamente 8 dígitos.</ng-container>
      </small>
    </label>

      <div class="actions">
        <button type="submit" class="btn-primary" [disabled]="invalid">Confirmar</button>
        <button type="button" class="btn-ghost" (click)="cancel()">Cancelar</button>
      </div>
    </div>

    <!-- Columna derecha: uploader circular -->
    <div class="col photo-col">
      <div class="photo-wrap">
        <img [src]="previewUrl" alt="Foto del cliente" />
        <div class="overlay">
          <button type="button" class="pick" (click)="onPickPhoto(fileInput)">
            + Agregar foto
          </button>
          <button type="button" class="remove" (click)="removePhoto()" *ngIf="previewUrl !== defaultAvatar">
            Quitar
          </button>
        </div>
        <input #fileInput type="file" class="hidden-input" accept="image/*" (change)="onPhotoSelected($event)" />
      </div>
    </div>
  </form>
</div>
